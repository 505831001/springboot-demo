drop table if exists qrtz_triggers;
drop table if exists qrtz_job_details;
drop table if exists qrtz_cron_triggers;
drop table if exists qrtz_simprop_triggers;
drop table if exists qrtz_simple_triggers;
drop table if exists qrtz_fired_triggers;
drop table if exists qrtz_blob_triggers;
drop table if exists qrtz_locks;
drop table if exists qrtz_scheduler_state;
drop table if exists qrtz_paused_trigger_grps;
drop table if exists qrtz_calendars;

-- 01.存储已配置的触发器(Trigger)的信息
create table qrtz_triggers (
	sched_name varchar (120) not null,
	trigger_name varchar (100) not null,
	trigger_group varchar (100) not null,
	job_name varchar (100) not null,
	job_group varchar (100) not null,
	description varchar (250) null,
	next_fire_time bigint (13) null,
	prev_fire_time bigint (13) null,
	priority integer null,
	trigger_state varchar (16) not null,
	trigger_type varchar (8) not null,
	start_time bigint (13) not null,
	end_time bigint (13) null,
	calendar_name varchar (100) null,
	misfire_instr smallint (2) null,
	job_data blob null,
	primary key (
		sched_name,
		trigger_name,
		trigger_group
	),
	foreign key (
		sched_name,
		job_name,
		job_group
	) references qrtz_job_details (
		sched_name,
		job_name,
		job_group
	)
);

-- 02.Job详细信息表(存储每一个已配置的Job的详细信息)
create table qrtz_job_details (
	sched_name varchar (120) not null,
	job_name varchar (100) not null,
	job_group varchar (100) not null,
	description varchar (250) null,
	job_class_name varchar (250) not null,
	is_durable varchar (1) not null,
	is_nonconcurrent varchar (1) not null,
	is_update_data varchar (1) not null,
	requests_recovery varchar (1) not null,
	job_data blob null,
	primary key (
		sched_name,
		job_name,
		job_group
	)
);

-- 03.Cron表达式和时区信息表(存储Cron Trigger,包括Cron表达式和时区信息)
create table qrtz_cron_triggers (
	sched_name varchar (120) not null,
	trigger_name varchar (100) not null,
	trigger_group varchar (100) not null,
	cron_expression varchar (100) not null,
	time_zone_id varchar (80),
	primary key (
		sched_name,
		trigger_name,
		trigger_group
	),
	foreign key (
		sched_name,
		trigger_name,
		trigger_group
	) references qrtz_triggers (
		sched_name,
		trigger_name,
		trigger_group
	)
);

-- 04.Simple表达式和时区信息表(存储Simple Trigger,包括Simple表达式和时区信息)
create table qrtz_simprop_triggers (
	sched_name varchar (120) not null,
	trigger_name varchar (100) not null,
	trigger_group varchar (100) not null,
	str_prop_1 varchar (512) null,
	str_prop_2 varchar (512) null,
	str_prop_3 varchar (512) null,
	int_prop_1 int null,
	int_prop_2 int null,
	long_prop_1 bigint null,
	long_prop_2 bigint null,
	dec_prop_1 numeric (13, 4) null,
	dec_prop_2 numeric (13, 4) null,
	bool_prop_1 varchar (1) null,
	bool_prop_2 varchar (1) null,
	primary key (
		sched_name,
		trigger_name,
		trigger_group
	),
	foreign key (
		sched_name,
		trigger_name,
		trigger_group
	) references qrtz_triggers (
		sched_name,
		trigger_name,
		trigger_group
	)
);

-- 05.Simple存储简单的触发器(Simple Trigger)，包括重复次数，间隔，以及已触的次数
create table qrtz_simple_triggers (
	sched_name varchar (120) not null,
	trigger_name varchar (100) not null,
	trigger_group varchar (100) not null,
	repeat_count bigint (7) not null,
	repeat_interval bigint (12) not null,
	times_triggered bigint (10) not null,
	primary key (
		sched_name,
		trigger_name,
		trigger_group
	),
	foreign key (
		sched_name,
		trigger_name,
		trigger_group
	) references qrtz_triggers (
		sched_name,
		trigger_name,
		trigger_group
	)
);

-- 06.Trigger状态信息和Job执行信息表(存储与已触发的Trigger相关的状态信息,以及相联Job的执行信息)
create table qrtz_fired_triggers (
	sched_name varchar (120) not null,
	entry_id varchar (95) not null,
	trigger_name varchar (100) not null,
	trigger_group varchar (100) not null,
	instance_name varchar (100) not null,
	fired_time bigint (13) not null,
	sched_time bigint (13) not null,
	priority integer not null,
	state varchar (16) not null,
	job_name varchar (100) null,
	job_group varchar (100) null,
	is_nonconcurrent varchar (1) null,
	requests_recovery varchar (1) null,
	primary key (sched_name, entry_id)
);

-- 07.Blob类型存储表(用于Quartz用户用JDBC创建他们自己定制的Trigger类型,JobStore并不知道如何存储实例的时候)
create table qrtz_blob_triggers (
	sched_name varchar (120) not null,
	trigger_name varchar (100) not null,
	trigger_group varchar (100) not null,
	blob_data blob null,
	primary key (
		sched_name,
		trigger_name,
		trigger_group
	),
	foreign key (
		sched_name,
		trigger_name,
		trigger_group
	) references qrtz_triggers (
		sched_name,
		trigger_name,
		trigger_group
	)
);

-- 08.存储程序的悲观锁的信息(假如使用了悲观锁)
create table qrtz_locks (
	sched_name varchar (120) not null,
	lock_name varchar (40) not null,
	primary key (sched_name, lock_name)
);

-- 09.存储少量的有关调度器(Scheduler)的状态信息，和别的调度器(Scheduler)实例(假如是用于一个集群中)
create table qrtz_scheduler_state (
	sched_name varchar (120) not null,
	instance_name varchar (100) not null,
	last_checkin_time bigint (13) not null,
	checkin_interval bigint (13) not null,
	primary key (sched_name, instance_name)
);

-- 10.存储已暂停的触发器(Trigger)组的信息
create table qrtz_paused_trigger_grps (
	sched_name varchar (120) not null,
	trigger_group varchar (100) not null,
	primary key (sched_name, trigger_group)
);

-- 11.Calendar日历信息表(以Blob类型存储Quartz的Calendar日历信息,quartz可配置一个日历来指定一个时间范围)
create table qrtz_calendars (
	sched_name varchar (120) not null,
	calendar_name varchar (100) not null,
	calendar blob not null,
	primary key (sched_name, calendar_name)
);

commit;
